<!DOCTYPE html>
<!-- saved from url=(0035)http://endoflow.com/tone-generator/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Tone Generator - Minimal Web Audio Example</title>
<link href="http://endoflow.com/styles/temp.css" rel="stylesheet">
<link href="http://endoflow.com/styles/light.css" rel="stylesheet">
<link href="http://endoflow.com/util/prettify/prettify.css" rel="stylesheet">
<script src="./Tone Generator - Minimal Web Audio Example_files/prettify.js"></script>
<style>

.prettyprint {
  background-color: #fff;
  margin: 20px;
  width: 50%;
}
</style>
</head>
<body onload="prettyPrint()">
<h1>Tone Generator</h1>

<p>
  This is a <b>very</b> minimal example of how to programmatically create sounds using the
  new <a href="https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html">Web
  Audio APIs</a>.
</p>
<p>
  There are a <a href="http://chromium.googlecode.com/svn/trunk/samples/audio/index.html">bunch
  of examples on the Chromium site</a>, but they are rather more complex than you want in a
  hello world.
</p>
<p>
  <script src="./Tone Generator - Minimal Web Audio Example_files/minimal.js"></script><button onclick="playTone()">Play Tone</button>
</p>

<pre class="prettyprint"><span class="kwd">var</span><span class="pln"> ctx </span><span class="pun">=</span><span class="pln"> createAudioContext</span><span class="pun">();</span><span class="pln">

</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">ctx</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  document</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">
      </span><span class="str">'&lt;p&gt;Web Audio APIs&lt;/a&gt; don\'t appear to be '</span><span class="pln"> </span><span class="pun">+</span><span class="pln">
      </span><span class="str">'supported in your browser.&lt;/p&gt;'</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  document</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">
      </span><span class="str">'&lt;button onclick="playTone()"&gt;Play Tone&lt;/button&gt;'</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> playTone</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> node </span><span class="pun">=</span><span class="pln"> ctx</span><span class="pun">.</span><a href="https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#JavaScriptAudioNode-section"><span class="pln">createJavaScriptNode</span></a><span class="pun">(</span><span class="lit">1024</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  node</span><span class="pun">.</span><a href="https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#AudioProcessingEvent-section"><span class="pln">onaudioprocess</span></a><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">outputBuffer</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> left </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="pln">getChannelData</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> right </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="pln">getChannelData</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> left</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      left</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> right</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">sin</span><span class="pun">(</span><span class="lit">2000</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">PI </span><span class="pun">*</span><span class="pln"> offset</span><span class="pun">++</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">44100</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">};</span><span class="pln">
  node</span><span class="pun">.</span><a href="https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#AudioNode-section"><span class="pln">connect</span></a><span class="pun">(</span><span class="pln">ctx</span><span class="pun">.</span><a href="https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#AudioDestinationNode-section"><span class="pln">destination</span></a><span class="pun">);</span><span class="pln">

  setTimeout</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> node</span><span class="pun">.</span><a href="https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#AudioNode-section"><span class="pln">disconnect</span></a><span class="pun">();</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> createAudioContext</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="str">'AudioContext'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> window</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><a href="https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#AudioContext-section"><span class="typ">AudioContext</span></a><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="str">'webkitAudioContext'</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> window</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> webkitAudioContext</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></pre>



</body></html>